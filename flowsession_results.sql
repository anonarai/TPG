select id, run_no, created_on, ended_on, contact_id, flow,

ifnull(results:channel:category::text, results:channel_type:category::text) as channel,
results:trigger_word:category:: text as language,
results:application:corrected as started,
results:communicationtool:category as communicationtool,
results:completesponsoridentification:category as completesponsoridentification,
results:easytounderstand:category as easy,
results:easytounderstandcompleteapplication:category as easytounderstand,
results:facetoface:category as facetoface,
results:facetofacesatisfaction:category as facetofacesatisfaction,
results:furtherassistance:category as furtherassistance,
results:difficulttocomplete:category as difficultitems,
results:specialisthelpcompletesponsoridentification:category as specialisthelp,
results:unificationspecialisthelp:category as unificationspecialisthelp,
results:unificationspecialisthelpcomplete:category as unificationspecialisthelpcomplete,
results:unificationspecialistsatisfaction:category as unificationspecialistsatisfaction,
contact:a_number:number:text::text as a_number,
contact:carrier_name:text::text as carrier_name,
contact:carrier_type:text::text as carrier_type,
contact:child_country_of_origin:text::text as country,
contact:child_last_name1:text::text as child_last_name1,
contact:child_first_name1:text::text as child_first_name1,
contact:discharge_date:text::text as discharge_date,
contact:lus:text::text as lus,
contact:region:text::text as region,
contact:service_level:number::number as service_level,
contact:slus:text::text as slus,
contact:sponsor_first_name:text::text as sponsor_first_name,
contact:sponsor_last_name:text::text as sponsor_last_name,
contact:sponsorcat:text::text as sponsorcat,
contact:state:text::text as state,
contact:survey_date:datetime::datetime as survey_date,
contact:us:text::text as us,
contact:zipcode:number::number as zipcode
from {{ref('tpg_flowsession_contactfields')}}
order by id, run_no
